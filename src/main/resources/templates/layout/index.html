<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<title>CAMEDO HOUSE - Giày Thời Trang</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
<link
	href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"
	rel="stylesheet">

<style>
body {
	background-color: #f8f9fa;
}

.sticky-sidebar {
	position: sticky;
	top: 100px;
	z-index: 900;
}

.banner-img {
	width: 100%;
	height: 180px;
	object-fit: cover;
}

.logo-img {
	height: 40px;
	margin-right: 10px;
}

.nav-link {
	font-weight: 500;
	font-size: 1.05rem;
	transition: 0.3s;
}

.nav-link:hover {
	color: #ffc107 !important;
}

.navbar-nav {
	gap: 5px;
}

.admin-nav-link {
	font-size: 0.85rem !important;
	padding: 0.5rem 0.4rem !important;
	white-space: nowrap !important;
	display: flex;
	align-items: center;
}

.admin-nav-link i {
	font-size: 0.95rem;
	margin-right: 3px;
}

.admin-border {
	border-left: 1px solid rgba(255, 255, 255, 0.2) !important;
	margin-left: 5px !important;
	padding-left: 5px !important;
}

.admin-dropdown .dropdown-item {
	font-size: 0.85rem;
}

.admin-dropdown .dropdown-item:hover {
	background-color: #e3f2fd;
	color: #0d6efd;
}
</style>
</head>
<body>
	<div class="container-fluid p-0">
		<img th:src="@{/images/banner.jpg}" class="banner-img" alt="Banner">
	</div>

	<nav
		class="navbar navbar-expand-lg navbar-dark bg-dark mb-4 sticky-top shadow">
		<div class="container-fluid px-5">
			<div class="d-flex align-items-center">
				<a
					class="navbar-brand d-flex align-items-center text-warning fw-bold me-3"
					th:href="@{/home/index}"> <img th:src="@{/images/logo.png}"
					class="logo-img" alt="Logo"> CAMEDO
				</a>
				<ul class="navbar-nav d-none d-lg-flex align-items-center">
					<li class="nav-item"><a class="nav-link active"
						th:href="@{/home/index}">Trang chủ</a></li>

					<th:block th:if="${session.user != null and session.user.admin}">

						<li class="nav-item dropdown admin-border"><a
							class="nav-link dropdown-toggle text-info admin-nav-link"
							href="#" id="productDropdown" role="button"
							data-bs-toggle="dropdown" aria-expanded="false"> <i
								class="bi bi-box-seam"></i> Sản phẩm
						</a>
							<ul class="dropdown-menu shadow mt-2 admin-dropdown"
								aria-labelledby="productDropdown">
								<li><a class="dropdown-item"
									th:href="@{/admin/product/index}"> <i
										class="bi bi-pencil-square me-2 text-primary"></i> Cập nhật
										sản phẩm
								</a></li>
								<li><a class="dropdown-item"
									th:href="@{/admin/category/index}"> <i
										class="bi bi-tags me-2 text-success"></i> Danh mục sản phẩm
								</a></li>
							</ul></li>

						<li class="nav-item"><a
							class="nav-link text-info admin-nav-link"
							th:href="@{/admin/order/index}"> <i class="bi bi-cart-check"></i>
								Đơn hàng
						</a></li>

						<li class="nav-item"><a
							class="nav-link text-info admin-nav-link"
							th:href="@{/admin/account/index}"> <i class="bi bi-people"></i>
								Tài khoản
						</a></li>

						<li class="nav-item"><a
							class="nav-link text-info admin-nav-link"
							th:href="@{/admin/report/revenue}"> <i
								class="bi bi-graph-up-arrow"></i> Doanh thu
						</a></li>

						<li class="nav-item"><a
							class="nav-link text-info admin-nav-link"
							th:href="@{/admin/report/vip}"> <i class="bi bi-trophy"></i>
								Khách hàng VIP
						</a></li>
					</th:block>
				</ul>
			</div>

			<button class="navbar-toggler" type="button"
				data-bs-toggle="collapse" data-bs-target="#navbarScroll">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarScroll">
				<ul class="navbar-nav ms-auto align-items-center gap-2">
					<li class="nav-item me-2"><a
						class="nav-link position-relative" th:href="@{/cart/view}"> <i
							class="bi bi-cart3 fs-5"></i> <span id="cart-badge"
							class="badge rounded-pill bg-danger position-absolute top-0 start-100 translate-middle"
							style="font-size: 0.65rem;"
							th:text="${session.cart != null ? session.cart.count : 0}">0</span>
					</a></li>

					<th:block th:if="${session.user == null}">
						<li class="nav-item"><a
							class="btn btn-outline-info btn-sm fw-bold px-3"
							th:href="@{/account/sign-up}">Đăng ký</a></li>
						<li class="nav-item"><a
							class="btn btn-outline-warning btn-sm fw-bold px-3"
							th:href="@{/auth/login}">Đăng nhập</a></li>
					</th:block>

					<th:block th:if="${session.user != null}">
						<li class="nav-item dropdown ms-2"><a
							class="nav-link dropdown-toggle text-warning fw-bold border border-warning rounded px-3"
							href="#" role="button" data-bs-toggle="dropdown"> <i
								class="bi bi-person-circle me-1"></i>
								[[${session.user.fullname}]]
						</a>
							<ul class="dropdown-menu dropdown-menu-end shadow mt-2">
								<li><a class="dropdown-item"
									th:href="@{/account/edit-profile}">Cập nhật tài khoản</a></li>
								<li><a class="dropdown-item"
									th:href="@{/account/change-password}">Đổi mật khẩu</a></li>
								<li><a class="dropdown-item" th:href="@{/order/list}">Lịch
										sử đơn hàng</a></li>
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item text-danger"
									th:href="@{/auth/logoff}">Đăng xuất</a></li>
							</ul></li>
					</th:block>
				</ul>
			</div>
		</div>
	</nav>

	<div class="container-fluid px-5" style="min-height: 600px;">
		<div class="row">
			<div class="col-md-2 mb-3">
				<div class="sticky-sidebar">
					<div th:replace="~{layout/menu :: menu}"></div>
				</div>
			</div>
			<div class="col-md-10">
				<div th:replace="~{${view}}"></div>
			</div>
		</div>
	</div>

	<footer class="bg-dark text-white text-center py-3 mt-4">
		<div th:replace="~{layout/footer :: footer}"></div>
	</footer>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<script th:inline="javascript">
        var msg = /*[[${message}]]*/ "";
        if (msg && msg !== "") {
            Swal.fire({
                icon: 'success', title: 'Thông báo', text: msg,
                confirmButtonColor: '#ffc107', timer: 3000
            });
        }

        function addToCart(productId) {
            fetch('/api/cart/add/' + productId)
                .then(res => res.text())
                .then(count => {
                    const badge = document.getElementById("cart-badge");
                    if (badge) badge.innerText = count;
                    Swal.fire({ 
                        toast: true, position: 'top-end', icon: 'success', 
                        title: 'Đã thêm vào giỏ hàng', showConfirmButton: false, timer: 1500 
                    });
                })
                .catch(err => console.error('Lỗi:', err));
        }
    </script>
</body>
</html>